#!/bin/bash


set -e
set -x


PROJECT_ENV=test


# Some debug statements
echo "User: $USER"
echo "Docker path: $(which docker)"
echo "Working directory: $PWD"
echo "Git revision: $(git log --oneline -n 1)"


sudo docker rm $PROJECT_ENV || true
sudo docker run \
    -e PROJECT_ENV=$PROJECT_ENV \
    -l $PROJECT_ENV \
    -v $PWD:/workspace \
    -w /workspace \
    --entrypoint /workspace/bin/entrypoint.sh \
    --name $PROJECT_ENV \
    python:latest \
    $PROJECT_ENV
